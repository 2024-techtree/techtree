<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>저축 기록 작성</title>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script>
        // 목표 이름이 변경될 때 호출되는 함수
        function fetchAndSetGoalType() {
            var goalName = $("#goalName").val(); // 선택된 목표 이름 가져오기
            var baseUrl = $("#baseUrl").val(); // 현재 페이지의 URL 가져오기

            // AJAX를 사용하여 서버에 요청
            $.get(baseUrl + "saving/goal/fetchGoalType?goalName=" + goalName, function (data) {
                // 응답을 받아와서 목표 유형 필드에 설정
                $("#goalType").val(data.goalType);
            });
        }
    </script>
</head>
<body>
<h2>저축 기록 작성</h2>

<form action="/saving/record/create" method="post" th:object="${recordDto}" id="recordForm">
    <label for="goalName">저축 목표 이름:</label>
    <select id="goalName" name="goalName" required onchange="fetchAndSetGoalType()">
        <option th:each="name : ${goalNames}" th:value="${name}" th:text="${name}" th:utext="${name}"></option>
    </select>
    <br>

    <label for="savingPrice">저축 금액:</label>
    <input type="number" id="savingPrice" name="savingPrice" required>
    <br>

    <label for="savingDate">저축 날짜:</label>
    <input type="date" id="savingDate" name="savingDate" required>
    <br>

    <label for="goalType">저축 목표 유형:</label>
    <input type="text" id="goalType" name="goalType" readonly>
    <br>

    <button type="submit">입력</button>
</form>

<!-- Thymeleaf에서 현재 페이지의 URL을 가져오기 위한 코드 -->
<input type="hidden" id="baseUrl" th:value="@{'/'}">
</body>
</html>
